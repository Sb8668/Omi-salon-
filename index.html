<!DOCTYPE html>
<html>
<head>
<title>OMI SALON – Book Appointment</title>
<link rel="stylesheet" href="style.css">
</head>
<body>

<div class="container">
  <h1>OMI SALON</h1>
  <p>Premium Luxury Salon Experience</p>

  <div class="card">
    <input id="name" placeholder="तुमचं नाव">
    <input id="phone" placeholder="मोबाईल नंबर">
    
    <select id="service">
      <option value="">सेवा निवडा</option>
      <option>Kes Cutting</option>
      <option>Daadhi</option>
      <option>Hair Color</option>
      <option>Facial</option>
    </select>

    <input type="date" id="date">

    <div id="slots"></div>

    <button onclick="book()">बुक करा</button>
    <p id="status"></p>
  </div>
</div>

<script type="module">
import { db, APP_ID } from './firebase.js';
import { collection, doc, setDoc, onSnapshot } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore.js";

let selectedTime = "";
const slotsDiv = document.getElementById("slots");

function renderSlots(booked={}) {
  slotsDiv.innerHTML="";
  for(let h=10;h<21;h++){
    for(let m of ["00","30"]){
      let t=`${h}:${m}`;
      let div=document.createElement("div");
      div.className="slot";
      div.innerText=t;
      if(booked[t]) div.classList.add("booked");
      div.onclick=()=>selectedTime=t;
      slotsDiv.appendChild(div);
    }
  }
}

renderSlots();

window.book = async () => {
  if(!selectedTime) return alert("वेळ निवडा");
  const date=document.getElementById("date").value;
  const ref=doc(db,"artifacts",APP_ID,"public","data",`bookings_${date}`,selectedTime.replace(":",""));
  await setDoc(ref,{
    name:name.value,
    phone:phone.value,
    service:service.value,
    time:selectedTime,
    date
  });
  window.location.href=`https://wa.me/919145627957`;
};
</script>
</body>
</html>
